<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mu-Basic</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: white; /* Arka planı beyaz yap */
            color: #1f2937; /* Yazı rengini koyu gri yap */
        }
        .view-section {
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }
        .view-section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        .nav-btn.active {
            color: #dc2626; /* Aktif navigasyon butonu kırmızı */
        }
        .nav-btn:hover {
            background-color: #e2e8f0;
        }
        .item-card {
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .item-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .card-media {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 0;
        }
        .card-content {
            position: relative;
            z-index: 1;
            background-color: rgba(255, 255, 255, 0.7); /* Opak arka plan */
            padding: 1rem;
            border-radius: 0.75rem;
        }
        #alert-message {
            transition: opacity 0.3s ease-in-out;
        }
        #music-player-bar {
            transition: transform 0.3s ease-in-out;
        }
        #media-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
            opacity: 0.2;
            transition: opacity 1s ease-in-out;
        }
        #admin-drag-drop-area {
            border: 2px dashed #94a3b8;
            background-color: #f1f5f9;
            transition: border-color 0.3s;
        }
        #admin-drag-drop-area.drag-over {
            border-color: #dc2626;
            background-color: #e2e8f0;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Arka Plan Medya Alanı -->
    <img id="media-background" src="" alt="Arka Plan Medya">
    <video id="video-background" class="hidden" loop muted autoplay playsinline></video>

    <!-- Başlık -->
    <header class="p-4 sm:p-6 text-center">
        <h1 class="text-4xl font-bold text-red-500">
            <span class="bg-clip-text text-transparent bg-gradient-to-r from-red-500 to-rose-600">
                Mu-Basic
            </span>
        </h1>
    </header>

    <!-- Ana İçerik Alanı -->
    <div class="flex-1 p-4 sm:p-8 overflow-y-auto">
        <!-- Ana Sayfa -->
        <div id="home-view" class="view-section active">
            <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">Müzikler</h2>
            <div id="song-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                <!-- Müzikler buraya JavaScript ile eklenecek -->
            </div>
            <p id="no-songs-message" class="text-center text-gray-500 mt-10 hidden">
                Henüz müzik eklemedin. Admin panelinden yükleyebilirsin.
            </p>
        </div>

        <!-- Favoriler Sayfası -->
        <div id="favorites-view" class="view-section">
            <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">Favoriler</h2>
            <div id="favorite-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                <!-- Favori müzikler buraya eklenecek -->
            </div>
            <p id="no-favorites-message" class="text-center text-gray-500 mt-10 hidden">
                Henüz favori müziğiniz yok.
            </p>
        </div>

        <!-- Yönetici (Admin) Sayfası -->
        <div id="admin-view" class="view-section">
            <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">Admin Paneli</h2>
            
            <!-- Giriş Formu -->
            <div id="admin-login" class="max-w-md mx-auto p-6 bg-slate-100 rounded-xl shadow-lg">
                <p class="text-lg text-center mb-4 text-gray-700">Lütfen şifrenizi girin.</p>
                <input type="password" id="admin-password" placeholder="Şifre" class="w-full p-3 rounded-lg bg-white text-gray-800 placeholder-gray-400 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500">
                <button onclick="login()" class="mt-4 w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-lg transition-colors">Giriş Yap</button>
            </div>

            <!-- Müzik Ekleme Alanı -->
            <div id="add-music-form" class="max-w-md mx-auto p-6 bg-slate-100 rounded-xl shadow-lg hidden">
                <h3 class="text-xl font-bold mb-4 text-center text-red-600">Yeni Müzik Ekle</h3>
                
                <input type="text" id="add-song-title" placeholder="Şarkı Adı" class="w-full p-3 mb-4 rounded-lg bg-white text-gray-800 placeholder-gray-400 border border-gray-300">
                <input type="text" id="add-song-artist" placeholder="Sanatçı Adı" class="w-full p-3 mb-4 rounded-lg bg-white text-gray-800 placeholder-gray-400 border border-gray-300">

                <div id="admin-drag-drop-area" class="w-full p-10 text-center rounded-lg cursor-pointer">
                    <p class="text-gray-500 mb-2">Dosyayı buraya sürükle bırak</p>
                    <p class="text-xs text-gray-600 mb-4">(Müzik ve medya dosyalarını birlikte seçebilirsiniz)</p>
                    <input type="file" id="drag-drop-input" class="hidden" multiple accept="audio/*, video/*, image/*">
                    <button onclick="document.getElementById('drag-drop-input').click()" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                        Dosya Seç
                    </button>
                </div>
                
                <div id="admin-song-list" class="mt-8 space-y-4">
                    <!-- Müzik listesi buraya gelecek -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Özel Uyarı Mesajı -->
    <div id="alert-message" class="fixed top-4 left-1/2 -translate-x-1/2 bg-red-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 opacity-0 hidden"></div>

    <!-- Müzik Çalar Çubuğu (Altta sabit) -->
    <div id="music-player-bar" class="fixed bottom-0 left-0 right-0 bg-slate-100 p-4 flex items-center justify-between z-50 transform translate-y-full">
        <div class="flex items-center space-x-4">
            <img id="player-art" src="https://placehold.co/60x60/f1f5f9/1f2937?text=Müzik" alt="Albüm Kapağı" class="w-12 h-12 rounded-lg">
            <div>
                <p id="player-title" class="text-sm font-semibold text-red-600"></p>
                <p id="player-artist" class="text-xs text-red-400"></p>
            </div>
        </div>
        <div class="flex items-center space-x-2">
            <button id="player-play-btn" class="p-2 rounded-full bg-red-600 text-white hover:bg-red-700 transition-colors">
                <svg id="player-play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path d="M8 5v14l11-7z"/></svg>
                <svg id="player-pause-icon" xmlns="http://www.w3.org/2d00/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 hidden"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
            </button>
        </div>
    </div>

    <!-- Navigasyon Çubuğu (Altta sabit) -->
    <div class="fixed bottom-0 left-0 right-0 h-16 flex items-center justify-around bg-slate-200 z-40">
        <button onclick="showView('home')" id="home-nav-btn" class="nav-btn flex-1 flex flex-col items-center justify-center py-2 text-xs font-medium text-gray-700 active">
            <svg class="w-6 h-6 mb-1" fill="currentColor" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
            Ana Sayfa
        </button>
        <button onclick="showView('favorites')" id="favorites-nav-btn" class="nav-btn flex-1 flex flex-col items-center justify-center py-2 text-xs font-medium text-gray-700">
            <svg class="w-6 h-6 mb-1" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3c3.08 0 5.5 2.42 5.5 5.5 0 3.78-3.4 6.86-8.55 11.54z"/></svg>
            Favoriler
        </button>
        <button onclick="showView('admin')" id="admin-nav-btn" class="nav-btn flex-1 flex flex-col items-center justify-center py-2 text-xs font-medium text-gray-700">
            <svg class="w-6 h-6 mb-1" fill="currentColor" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
            Admin
        </button>
    </div>

    <script>
        const SONG_STORAGE_KEY = 'musicAppData';
        const FAVORITES_STORAGE_KEY = 'musicAppFavorites';
        const ADMIN_PASSWORD = '1975';

        const audio = new Audio();
        let currentSong = null;
        let isPlaying = false;
        let songs = [];
        let favorites = [];

        // DOM elementlerini seçme
        const songListContainer = document.getElementById('song-list');
        const favoriteListContainer = document.getElementById('favorite-list');
        const noFavoritesMessage = document.getElementById('no-favorites-message');
        const noSongsMessage = document.getElementById('no-songs-message');
        const adminLogin = document.getElementById('admin-login');
        const addMusicForm = document.getElementById('add-music-form');
        const adminSongList = document.getElementById('admin-song-list');
        const playerBar = document.getElementById('music-player-bar');
        const playerTitle = document.getElementById('player-title');
        const playerArtist = document.getElementById('player-artist');
        const playerArt = document.getElementById('player-art');
        const playerPlayBtn = document.getElementById('player-play-btn');
        const playerPlayIcon = document.getElementById('player-play-icon');
        const playerPauseIcon = document.getElementById('player-pause-icon');
        const navButtons = document.querySelectorAll('.nav-btn');
        const alertMessage = document.getElementById('alert-message');
        const mediaBackground = document.getElementById('media-background');
        const videoBackground = document.getElementById('video-background');

        const dragDropArea = document.getElementById('admin-drag-drop-area');
        const fileInput = document.getElementById('drag-drop-input');
        
        // Navigasyon ve görünüm yönetimi (yumuşak geçişler ile)
        function showView(viewId) {
            document.querySelectorAll('.view-section').forEach(section => {
                section.classList.remove('active');
            });
            
            const activeSection = document.getElementById(`${viewId}-view`);
            activeSection.classList.add('active');
            
            navButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`${viewId}-nav-btn`).classList.add('active');

            if (viewId === 'favorites') {
                renderFavorites();
            } else if (viewId === 'admin') {
                renderAdminList();
            }
        }
        
        // Hata ve bilgi mesajlarını gösterme
        function showAlert(message) {
            alertMessage.innerText = message;
            alertMessage.classList.remove('hidden');
            setTimeout(() => {
                alertMessage.style.opacity = '1';
            }, 10);
            setTimeout(() => {
                alertMessage.style.opacity = '0';
                setTimeout(() => {
                    alertMessage.classList.add('hidden');
                }, 300);
            }, 3000);
        }

        // Yerel depolama verilerini yükleme
        function loadData() {
            try {
                const storedSongs = localStorage.getItem(SONG_STORAGE_KEY);
                if (storedSongs) {
                    songs = JSON.parse(storedSongs);
                } else {
                    songs = [];
                }

                const storedFavorites = localStorage.getItem(FAVORITES_STORAGE_KEY);
                if (storedFavorites) {
                    favorites = JSON.parse(storedFavorites);
                }
            } catch (e) {
                console.error("Yerel depolama verisi yüklenemedi", e);
                songs = [];
                favorites = [];
            }
        }

        // Verileri kaydetme
        function saveData() {
            localStorage.setItem(SONG_STORAGE_KEY, JSON.stringify(songs));
            localStorage.setItem(FAVORITES_STORAGE_KEY, JSON.stringify(favorites));
        }

        // Ana sayfayı oluşturma
        function renderSongs() {
            songListContainer.innerHTML = '';
            if (songs.length === 0) {
                noSongsMessage.classList.remove('hidden');
            } else {
                noSongsMessage.classList.add('hidden');
            }

            songs.forEach(song => {
                const isFavorite = favorites.includes(song.id);
                const item = createSongCard(song, isFavorite);
                songListContainer.appendChild(item);
            });
        }

        // Favorileri oluşturma
        function renderFavorites() {
            favoriteListContainer.innerHTML = '';
            if (favorites.length === 0) {
                noFavoritesMessage.classList.remove('hidden');
                return;
            }
            noFavoritesMessage.classList.add('hidden');
            const favoriteSongs = songs.filter(song => favorites.includes(song.id));
            favoriteSongs.forEach(song => {
                const isFavorite = favorites.includes(song.id);
                const item = createSongCard(song, isFavorite);
                favoriteListContainer.appendChild(item);
            });
        }

        // Şarkı kartı oluşturma
        function createSongCard(song, isFavorite) {
            const card = document.createElement('div');
            card.classList.add('item-card', 'bg-slate-100', 'rounded-xl', 'p-4', 'shadow-md', 'flex', 'flex-col', 'items-center', 'text-center');
            
            card.innerHTML = `
                <div class="w-full h-48 rounded-lg relative overflow-hidden flex items-center justify-center bg-slate-200">
                    <p class="text-xl font-bold text-gray-400">
                        ${song.hasMedia ? 'Oynatmak İçin Tıkla' : 'Medya Yok'}
                    </p>
                </div>
                <h3 class="text-lg font-semibold truncate w-full mt-4 text-red-600">${song.title}</h3>
                <p class="text-sm text-red-400 truncate w-full">${song.artist}</p>
                <div class="flex items-center space-x-2 mt-4">
                    <button class="play-btn p-2 rounded-full bg-red-600 hover:bg-red-700 text-white transition-colors" data-id="${song.id}">
                        <svg class="w-5 h-5 fill-current" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                    </button>
                    <button class="fav-btn p-2 rounded-full bg-slate-200 hover:bg-slate-300 text-gray-700 transition-colors" data-id="${song.id}">
                        <svg class="w-5 h-5 fill-current ${isFavorite ? 'text-red-400' : 'text-gray-400'}" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3c3.08 0 5.5 2.42 5.5 5.5 0 3.78-3.4 6.86-8.55 11.54z"/></svg>
                    </button>
                </div>
            `;
            const playButton = card.querySelector('.play-btn');
            const favButton = card.querySelector('.fav-btn');

            playButton.addEventListener('click', () => playSong(song.id));
            favButton.addEventListener('click', () => toggleFavorite(song.id));

            return card;
        }

        // Müzik çalma
        function playSong(songId) {
            const songToPlay = songs.find(s => s.id === songId);
            if (!songToPlay) return;

            if (currentSong && currentSong.id === songId && isPlaying) {
                audio.pause();
                isPlaying = false;
            } else if (currentSong && currentSong.id === songId) {
                audio.play();
                isPlaying = true;
            } else {
                currentSong = songToPlay;
                audio.src = currentSong.musicUrl;
                audio.play();
                isPlaying = true;
                
                // Medya dosyası varsa medya seçme penceresini aç
                if (currentSong.hasMedia) {
                    const tempInput = document.createElement('input');
                    tempInput.type = 'file';
                    tempInput.accept = currentSong.mediaType;
                    tempInput.style.display = 'none';
                    document.body.appendChild(tempInput);
                    
                    tempInput.addEventListener('change', (event) => {
                        const file = event.target.files[0];
                        if (file) {
                            const url = URL.createObjectURL(file);
                            if (currentSong.mediaType.startsWith('video')) {
                                videoBackground.src = url;
                                videoBackground.classList.remove('hidden');
                                mediaBackground.classList.add('hidden');
                            } else {
                                mediaBackground.src = url;
                                mediaBackground.classList.remove('hidden');
                                videoBackground.classList.add('hidden');
                            }
                        } else {
                            // Dosya seçilmezse arka planı temizle
                            mediaBackground.src = '';
                            videoBackground.src = '';
                        }
                        document.body.removeChild(tempInput);
                    });
                    
                    tempInput.click();
                } else {
                    // Medya yoksa arka planı temizle
                    mediaBackground.src = '';
                    videoBackground.src = '';
                }
            }
            
            updatePlayerBar();
            togglePlayPauseIcon();
        }

        // Oynatma çubuğunu güncelleme
        function updatePlayerBar() {
            if (currentSong) {
                playerBar.classList.remove('translate-y-full');
                playerTitle.innerText = currentSong.title;
                playerArtist.innerText = currentSong.artist;
                playerArt.src = currentSong.hasMedia ? "https://placehold.co/60x60/f1f5f9/1f2937?text=Medya" : "https://placehold.co/60x60/f1f5f9/1f2937?text=Müzik";
            }
        }

        // Oynat/Duraklat simgesini değiştirme
        function togglePlayPauseIcon() {
            if (isPlaying) {
                playerPlayIcon.classList.add('hidden');
                playerPauseIcon.classList.remove('hidden');
            } else {
                playerPlayIcon.classList.remove('hidden');
                playerPauseIcon.classList.add('hidden');
            }
        }
        
        // Ses durumu dinleyicileri
        audio.addEventListener('play', () => { isPlaying = true; togglePlayPauseIcon(); });
        audio.addEventListener('pause', () => { isPlaying = false; togglePlayPauseIcon(); });
        audio.addEventListener('ended', () => { isPlaying = false; togglePlayPauseIcon(); });

        // Oynatma çubuğundaki düğme
        playerPlayBtn.addEventListener('click', () => {
            if (currentSong) {
                if (isPlaying) {
                    audio.pause();
                } else {
                    audio.play();
                }
            }
        });

        // Favori ekleme/kaldırma
        function toggleFavorite(songId) {
            const index = favorites.indexOf(songId);
            if (index > -1) {
                favorites.splice(index, 1);
                showAlert("Favorilerden kaldırıldı.");
            } else {
                favorites.push(songId);
                showAlert("Favorilere eklendi!");
            }
            saveData();
            renderSongs();
            if (document.getElementById('favorites-view').classList.contains('active')) {
                renderFavorites();
            }
        }

        // Admin giriş
        function login() {
            const passwordInput = document.getElementById('admin-password').value;
            if (passwordInput === ADMIN_PASSWORD) {
                adminLogin.classList.add('hidden');
                addMusicForm.classList.remove('hidden');
                renderAdminList();
            } else {
                showAlert("Yanlış şifre!");
            }
        }

        // Yönetici listesini oluşturma
        function renderAdminList() {
            adminSongList.innerHTML = `
                <h3 class="text-xl font-bold text-center mb-4 text-gray-800">Müzikleri Yönet</h3>
            `;
            if (songs.length === 0) {
                adminSongList.innerHTML += `<p class="text-center text-gray-500">Henüz müzik yok.</p>`;
                return;
            }
            songs.forEach(song => {
                const item = document.createElement('div');
                item.classList.add('flex', 'items-center', 'justify-between', 'bg-slate-200', 'p-3', 'rounded-lg');
                item.innerHTML = `
                    <div class="flex-1 mr-4">
                        <p class="font-semibold truncate text-red-600">${song.title}</p>
                        <p class="text-sm text-red-400 truncate">${song.artist}</p>
                    </div>
                    <button class="delete-btn bg-red-600 hover:bg-red-700 text-white p-2 rounded-lg" data-id="${song.id}">
                        Sil
                    </button>
                `;
                const deleteBtn = item.querySelector('.delete-btn');
                deleteBtn.addEventListener('click', () => deleteMusic(song.id));
                adminSongList.appendChild(item);
            });
        }

        // Sürükle-bırak olayları
        dragDropArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            dragDropArea.classList.add('drag-over');
        });

        dragDropArea.addEventListener('dragleave', () => {
            dragDropArea.classList.remove('drag-over');
        });

        dragDropArea.addEventListener('drop', (e) => {
            e.preventDefault();
            dragDropArea.classList.remove('drag-over');
            handleFiles(e.dataTransfer.files);
        });

        // Dosya seçme inputu olayları
        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });

        // Dosyaları işleme
        function handleFiles(files) {
            const musicFile = Array.from(files).find(file => file.type.startsWith('audio'));
            const mediaFile = Array.from(files).find(file => file.type.startsWith('video') || file.type.startsWith('image'));
            
            const titleInput = document.getElementById('add-song-title');
            const artistInput = document.getElementById('add-song-artist');

            if (!musicFile) {
                showAlert("Lütfen bir müzik dosyası seçin (.mp3, .wav, vb.).");
                return;
            }

            if (!titleInput.value || !artistInput.value) {
                showAlert("Lütfen şarkı adı ve sanatçı adı girin.");
                return;
            }

            const musicReader = new FileReader();
            musicReader.onload = function(musicEvent) {
                const musicUrl = musicEvent.target.result;
                
                const newSong = {
                    id: Date.now(),
                    title: titleInput.value,
                    artist: artistInput.value,
                    musicUrl: musicUrl,
                    hasMedia: !!mediaFile,
                    mediaType: mediaFile ? mediaFile.type : null
                };

                songs.push(newSong);
                saveData();
                renderSongs();
                renderAdminList();
                titleInput.value = '';
                artistInput.value = '';
                showAlert("Müzik başarıyla eklendi!");
            };

            musicReader.onerror = function() {
                showAlert("Müzik dosyası okuma hatası.");
            };
            musicReader.readAsDataURL(musicFile);
        }

        // Müzik silme
        function deleteMusic(songId) {
            songs = songs.filter(song => song.id !== songId);
            favorites = favorites.filter(id => id !== songId); // Favorilerden de sil
            saveData();
            renderSongs();
            renderAdminList();
            showAlert("Müzik başarıyla silindi.");
        }

        // Uygulamayı başlatma
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            renderSongs();
        });
    </script>
</body>
</html>
